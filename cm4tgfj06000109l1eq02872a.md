---
title: "Deployed a Reddit Clone on Kubernetes with Ingress Enabled"
datePublished: Wed Dec 18 2024 05:30:56 GMT+0000 (Coordinated Universal Time)
cuid: cm4tgfj06000109l1eq02872a
slug: deployed-a-reddit-clone-on-kubernetes-with-ingress-enabled
cover: https://cdn.hashnode.com/res/hashnode/image/upload/v1760878093643/c1d9cbd1-d1d7-4fa0-abbc-d49743d83416.png
tags: kubernetes, devops, 90daysofdevops

---

## **Table of contents**

* [Setup CI server:](https://namg.hashnode.dev/deployed-a-reddit-clone-on-kubernetes-with-ingress-enabled#heading-setup-ci-server)
    
* [Setup Deployment server:](https://namg.hashnode.dev/deployed-a-reddit-clone-on-kubernetes-with-ingress-enabled#heading-setup-deployment-server)
    
* [minikube addons enable ingress](https://namg.hashnode.dev/deployed-a-reddit-clone-on-kubernetes-with-ingress-enabled#heading-minikube-addons-enable-ingress)
    

---

### **Setup CI server:**

1. Launch an ec2 instance with Ubuntu- t2.micro AMI type
    
2. Install Docker:
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693561948662/14206b07-81f5-4f71-8fa9-ceed9a4f7711.png?auto=compress,format&format=webp align="left")
    
3. Clone Reddit app source code:  
    [`https://github.com/Namg04/reddit-clone-k8s-ingress.git`](https://github.com/Namg04/reddit-clone-k8s-ingress.git)
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693562208474/20c366b9-8372-4477-8544-d100f55d4d8e.png?auto=compress,format&format=webp align="left")
    
4. Create a docker image from the Dockerfile
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693562319707/b3aacae6-db60-483e-897f-245d70a9c5b6.png?auto=compress,format&format=webp align="left")
    
5. `docker build . -t reddit-clone-image:latest`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693563171650/d755acae-bbc6-4e19-9b8f-46d5c853ae50.png?auto=compress,format&format=webp align="left")
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693563205458/bdb0d91b-4f61-48ec-8777-2ff8228e9965.png?auto=compress,format&format=webp align="left")
    
6. Image has been created : `sudo docker images`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693563290413/8efde76f-49b5-42fd-89c0-a65ae962b188.png?auto=compress,format&format=webp align="left")
    
7. Push the Reddit image to the DockerHub. Log in to the DockerHub from CLI
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693563729019/c0e59d4e-7fd9-4c6b-8634-b54787beaedb.png?auto=compress,format&format=webp align="left")
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693564233484/0432de1e-6b80-4b6a-a578-4c6908c766a0.png?auto=compress,format&format=webp align="left")
    
8. You can verify the image from DockerHub as well once the image has been pushed:
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693564324546/8b67ba4f-43ef-4407-a19b-afc04e0479ca.png?auto=compress,format&format=webp align="left")
    
    ---
    

### **Setup Deployment server:**

1. Launch instance for Deployment server: Ubuntu AMI, t2.medium
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693564729800/8112d3b1-8f09-43b8-8f88-553696ff14bf.png?auto=compress,format&format=webp align="left")
    
2. Install Docker and Minikube + Kubectl  
    <mark># For Docker Installation</mark>  
    `sudo apt-get update sudo apt-get install` [`docker.io`](http://docker.io/) `-y sudo usermod -aG docker $USER && newgrp docker`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693565057659/4a419006-5f90-4897-b35f-7f9b7fe4984c.png?auto=compress,format&format=webp align="left")
    
    <mark># For Minikube &amp; Kubectl</mark>  
    `curl -LO` [`https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64`  
    `sudo`](https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64%EF%BF%BCsudo) `install minikube-linux-amd64 /usr/local/bin/minikube`  
    `sudo snap install kubectl --classic`  
    `minikube start --driver=docker`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693565132548/e909191e-ffab-4952-8bd4-596c6fa3110f.png?auto=compress,format&format=webp align="left")
    
3. Create a project directory to write required manifest files
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693565367926/86eb7af7-82fe-4408-a480-e2991c1de4c4.png?auto=compress,format&format=webp align="left")
    
4. Create namespace `kubectl create namespace reddit-app`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693565847990/f9504ce7-00db-4957-b26f-7653bf0159b8.png?auto=compress,format&format=webp align="left")
    
5. Write Deployment manifest file
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693565723522/c7cf8157-57d2-4a36-a88d-1533f17f3dd1.png?auto=compress,format&format=webp align="left")
    
6. Run the deployment file by using `kubectl apply -f Deployment.yml -n reddit-app`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693566011434/0ae33068-eafa-46d7-b0f4-c2d76216e71b.png?auto=compress,format&format=webp align="left")
    
7. Write service.yml file
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693566240543/8c1dd8c9-292e-484a-9608-8fdd50fe0d3c.png?auto=compress,format&format=webp align="left")
    
8. Run the Service.yml file: `kubectl apply -f Service.yml -n reddit-app`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693566402215/10821b41-e19d-42a2-b711-73c1a87feb12.png?auto=compress,format&format=webp align="left")
    
9. Get the URL : `minikube service reddit-clone-service -n reddit-app created --url`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693566775690/7b17153b-545e-4976-b8f1-a6d088abc0e7.png?auto=compress,format&format=webp align="left")
    
10. Expose the App Deployment:  
    `kubectl expose deployment reddit-clone-deployment -n reddit-app --type=NodePort`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693567271785/625663b4-129f-4fe0-a216-2b813563db3d.png?auto=compress,format&format=webp align="left")
    
11. Expose the App Service:  
    `kubectl port-forward svc/reddit-clone-service -n reddit-app 3000:3000 --address 0.0.0.0`
    
12. Open 3000 port in the Deployment Server of the security group
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693567976150/049c1826-a4aa-4a23-8667-542041fbb136.png?auto=compress,format&format=webp align="left")
    
13. Access your Reddit app:
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693568030579/be371d6e-7470-4651-991f-5c51ae53f313.png?auto=compress,format&format=webp align="left")
    

ðŸ’¥ðŸ’¥ðŸ’¥BoomðŸ’¥ðŸ’¥ðŸ’¥

---

### minikube addons enable ingress

**Ingress:**

Pods and services in Kubernetes have their own IP; however, it is normally not the interface youâ€™d provide to the external internet. Though there is a service with node IP configured, the port in the node IP canâ€™t be duplicated among the services. It is cumbersome to decide which port to manage with which service.

Furthermore, the node comes and goes, it wouldnâ€™t be clever to provide a static node IP to an external service. Ingress defines a set of rules that allows the inbound connection to access Kubernetes cluster services. It brings the traffic into the cluster at L7 and allocates and forwards a port on each VM to the service port. This is shown in the following figure. We define a set of rules and post them as source type ingress to the API server. When the traffic comes in, the ingress controller will then fulfill and route the ingress by the ingress rules. As shown in the following figure, ingress is used to route external traffic to the Kubernetes endpoints by different URLs:

![](https://miro.medium.com/v2/resize:fit:875/0*zqoXgMWSIULrsmMG.png align="left")

1. Write ingress.yml file
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693568431864/d5041975-308b-4eb4-b9bb-da21c9cd5e87.png?auto=compress,format&format=webp align="left")
    
2. Enable minikube ingress: `minikube addons enable ingress`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693568532653/d2d0797b-735c-4a6c-84c6-75110f52483f.png?auto=compress,format&format=webp align="left")
    
3. Check the Current settings of addons in Minikube: `minikube addons list`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693568633419/e4e538af-f32d-434d-8f36-9e134358dfd2.png?auto=compress,format&format=webp align="left")
    
4. Run ingress file: `kubectl apply -f ingress.yml -n reddit-app`  
    Check the created ingress file: `kubectl get ingress`
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693568773150/44560845-70b9-4161-b3a9-27e724010d78.png?auto=compress,format&format=webp align="left")
    
5. Test your ingress: <mark>curl -L </mark> [**domain.com/test**](http://domain.com/test)
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693569326717/ba9e5fa1-04db-487e-ba23-dcc9a73d737a.png?auto=compress,format&format=webp align="left")
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693569179400/c6143ea9-1530-4893-aba7-4806af2bce0e.png?auto=compress,format&format=webp align="left")
    
    ![](https://cdn.hashnode.com/res/hashnode/image/upload/v1693568030579/be371d6e-7470-4651-991f-5c51ae53f313.png align="left")
    
    You have successfully Deployed a Reddit Copy on Kubernetes with Ingress Enabled.
    

> ***"Thank you for reading my blog! Happy Learning!!!ðŸ˜Š***